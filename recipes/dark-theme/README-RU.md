[`English`](README.md) `Русский`
# Svelte kit Theme Example

Простой пример реализации двух цветовых схем.

- На основе CSS переменных
- По умолчанию использует системную тему
- Вкладка браузера в цвет темы
- Переключатель темы
- Запоминает выбор пользователя
- Проверяет выбранную тему на сервере
- Без вспышек при загрузке и переключении

<br>

Цвета схем определяются через css переменные в подключаемых файлах [static/styles/light.css](static/styles/light.css) и [static/styles/dark.css](static/styles/dark.css) соответственно.

Весь исполняющий код написан в [index.svelte](src/routes/index.svelte). Базовые стили страницы определяются через `:global` селектор.

<br>


## Run this 
Для запуска этого примера выполните команду из папки верхнего уровня (svelte-way):
```bash
npm i
npm run dark-theme
```

## Как работает переключение?
По умолчанию подключаются обе темы. Браузер сам выбирает какую использовать глядя на `media` правило `prefers-color-scheme`.

Если пользователь переключит тему вручную, то добавится выбранный файл темы без указания `media` правила. Это переопределит выбранные браузером стили.

Выбор пользователя сохраняется в `куках` и учитывается при следующих загрузках, включая `SSR`.

<br>

## Как сохраняется состояние?
Сперва мы проверяем через `load` функцию переключал ли пользователь тему сайта. Если да, то в куках есть ключ `theme` и мы сможем его прочитать из параметра `session.user`

Значение `theme` в куках проверяет хук [src/hooks.js](src/hooks.js), и кладёт результат проверки в `session`.

Если значение не присвоено, оно присвоится по умолчанию в `auto` через параметр по умолчанию в функции деструктуризации.

Далее из `load` функции мы передаём значение `theme` в макет, где оно уже привязано к группе радио-кнопок через двухсторонний биндинг.

При смене темы изменится значение переменной `theme` и запустится функция `saveUserTheme` которая через хэлпер-функцию устанавливает соответствующую `куку`.

В функции есть проверка на окружение, чтобы она запускалась только в браузере.

<br>

## Цвета табов
Используется метатег `theme-color`. Это указывает браузеру покрасить вкладки в целевой цвет.
